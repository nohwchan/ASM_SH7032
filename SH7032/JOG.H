;----------SIMULATION SIGNAL FOR TEST MULTI SPEED--------
;	MOV SEC2,R1
;	MOV.W @R1,R1
;	MOV R1,R2
;	MOV #31,R3
;	MOV R3,R4
;	DIVS R3,R2
;	MULS R2,R4
;	STS  MACL,R2
;	NEG  R2,R2
;	ADD  R2,R1
;	MOV #7,R2
;	CMP/GT R2,R1
;	BF  NOX
;	MOV #15,R2
;	CMP/GT R2,R1
;	BF  X1
;	MOV #23,R2
;	CMP/GT R2,R1
;	BF  XJOG
;	MOV #B'100,R0
;	BRA BEGIN
;	NOP
;NOX:
;	MOV #B'0,R0
;	BRA BEGIN
;	NOP
;XJOG:   MOV JOGBIT1,R0
;	BRA BEGIN
;	NOP
;X1:
;	MOV #B'1000,R0
;---------------------------------------------------
	MOV INP_HI,R1
	MOV.B @R1,R0		;INPORT HIGH BYTE OF EXTERNAL(FOR JOG CHECKING)

BEGIN:  
	TST #B'100000,R0	;TEST JOG(0 OR 1)
	BT  JOG			;IF JOG IN(JOG=0) THEN JMP TO JOG

	MOV QSTATUS1,R1
	MOV.B @R1,R2
	MOV #B'11111011,R3
	AND R3,R2
	MOV.B R2,@R1		;CLEAR JOG FLAG

	MOV INP_LO,R1
	MOV.W @R1,R0
	AND #B'00001100,R0	;MASK BIT FOR CHECK X1,X2

	TST #B'1000,R0		;ELSE TEST X1(0 OR 1) CONTINUE
	BT  CHK_X2		 
	TST #B'100,R0		;TEST X2(0 OR 1)  
	BF  RE_FLAST		;IF X1=1 AND X2=1 THEN JMP TO OUT_MUL(FSET NOT CHANGE) 
	MOV MUL_SP2,R1		;ELSE CHANGE FSET (FSET=MUL_SP2)
	MOV.W @R1,R0
	MOV FSET_3,R1
	MOV.W R0,@R1
	MOV RSTATUS2,R1
	MOV.B @R1,R0
	OR  #B'10000000,R0
	MOV.B R0,@R1		;SET EXTERNAL SPEED FLAG 
	BRA OUT_MUL
	NOP
CHK_X2:
	TST #B'100,R0		;TEST X2
	BT  RE_FLAST		;IF X1=0 AND X2=0 THEN JMP TO OUT_MUL(FSET NOT CHANGE)		
	MOV MUL_SP1,R1		;ELSE CHANGE FSET (FSET = MUL_SP1)
	MOV.W @R1,R0
	MOV FSET_3,R1
	MOV.W R0,@R1
	MOV RSTATUS2,R1
	MOV.B @R1,R0
	OR  #B'10000000,R0
	MOV.B R0,@R1		;SET EXTERNAL SPEED FLAG 
	BRA OUT_MUL
	NOP

RE_FLAST:
	MOV FLAST_2,R1
	MOV.W @R1,R1
	MOV FSET_3,R0
	MOV.W R1,@R0
	BRA OUT_MUL
	NOP
JOG:	
	MOV JOG_SP,R1
	MOV.W @R1,R0
	MOV FSET_3,R1
	MOV.W R0,@R1
	MOV RSTATUS2,R1
	MOV.B @R1,R0
	OR  #B'10000000,R0
	MOV.B R0,@R1		;SET EXTERNAL SPEED FLAG 
	
	MOV QSTATUS1,R1
	MOV.B @R1,R0
	OR  #B'100,R0
	MOV.B R0,@R1		;SET JOG FLAG ON

	BRA OUT_MUL
	NOP

		.ALIGN 4
INP_LO:		.DATA.L INPORT	
INP_HI:		.DATA.L IN_PORT2
SFLG1:		.DATA.L SYSFLG
FSET_3:		.DATA.L FSET
FLAST_2:	.DATA.L FLAST
;FRUN_3:	.DATA.L FRUN
PSTATUS3:	.DATA.L _P_STATUS
RSTATUS2:	.DATA.L _R_STATUS
QSTATUS1:	.DATA.L _Q_STATUS
MUL_SP1:	.DATA.L _MUL_SP1
MUL_SP2:	.DATA.L _MUL_SP2
JOG_SP:		.DATA.L _JOG_SP
SEC2:		.DATA.L SEC
;JOGBIT:	.DATA.L B'10000000000000
;MASKBIT:	.DATA.L B'10000000001100
;JOGBIT1:	.DATA.L B'10000000001100
OUT_MUL:
