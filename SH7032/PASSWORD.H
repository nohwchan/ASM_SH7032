;********************************************
;--------SHOW PASSWORD OF APY INVERTER------*
;********************************************
	MOV #0,R10
	MOV #101,R11
	MOV EEPROM_RD,R14		;GET VALUE FROM EEPROM AT #60
	JSR @R14;EE_RD
	NOP
	MOV R10,R0			;R0 = VALUE FROM EEPROM AT #60
	CMP/EQ #B'01101111,R0		;IF R0 <> 'A'
	BF  FIRST_USE			;THEN FIRST_USE
	MOV #0,R10
	MOV #102,R11
	MOV EEPROM_RD,R14
	JSR @R14;EE_RD
	NOP
	MOV R10,R0			;R0=VALUE FROM EEPROM AT #61
	CMP/EQ #B'00101111,R0		;IF R0 <> 'P'
	BF  FIRST_USE			;THEN FIRST_USE
	MOV #0,R10
	MOV #103,R11
	MOV EEPROM_RD,R14
	JSR @R14;EE_RD
	NOP
	MOV R10,R0			;R0=VALUE FROM EEPROM AT #63
	CMP/EQ #B'01011101,R0		;IF R0 <> 'Y'
	BF  FIRST_USE			;THEN FIRST_USE
	BRA NOT_FIRST_USE
	NOP	
	
		
FIRST_USE:
	MOV S_STATUS7,R1
	MOV.B @R1,R0
	OR #B'10000000,R0	;SET FIRST TIME (SHOW PASS) FLAG
	MOV.B R0,@R1

SHOW_PASS:

	MOV PASS1,R10
	MOV DATBUF,R11
	MOV R10,@R11
	MOV #5,R2
	MOV DOT,R1
	MOV.B R2,@R1
	MOV SCAN4,R14
	JSR @R14;SCAN		;SHOW PASS
	NOP
	MOV KEY4,R14
	JSR @R14;KEYPROC	;SCAN KEYPAD
	NOP	
	MOV CODE,R1
	MOV.B @R1,R0
	CMP/EQ #4,R0		;IF CODE <> 4
	BF  WRONG_CODE		;THEN WRONG CODE
	MOV #0,R0		;ELSE CLEAR CODE
	MOV.B R0,@R1
	MOV S_STATUS7,R1
	MOV.B @R1,R0
	AND #B'01111111,R0	;CLEAR FIRST MODE FLAG
	MOV.B R0,@R1	
	BRA OUT_PASSWORD
	NOP

;LOOP ABOUT 1ms FOR SCAN KEY&DISPLAY
WRONG_CODE:
	MOV #0,R0
NO_LOOP1:
	ADD #1,R0
	MOV V2500,R1		
	CMP/EQ R1,R0
	BF  NO_LOOP1
	BRA SHOW_PASS
	NOP

	.ALIGN 4
EEPROM_RD:	.DATA.L EE_RD
CODE:		.DATA.L _CODE
PASS1:		.DATA.L B'01011110010111100110111100101111
	.ALIGN 4
OUT_PASSWORD:
	
